namespace = cbshing_origins_eternal_leader_event
# by cbshing

@tier1influencecontact = 7
@tier1influencecontactxenophile = 8
@tier1influencecontactmin = 20
@tier1influencecontactmax = 80

@tier2influencecontact = 10
@tier2influencecontactxenophile = 12
@tier2influencecontactmin = 40
@tier2influencecontactmax = 100

@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000
@tier5materialreward = 48
@tier5materialmin = 700
@tier5materialmax = 4000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300
@tier5influencereward = 36
@tier5influencemin = 250
@tier5influencemax = 500
@tier6influencereward = 48
@tier6influencemin = 300
@tier6influencemax = 600

@tier1unityreward = 6
@tier1unitymin = 100
@tier1unitymax = 500
@tier2unityreward = 12
@tier2unitymin = 150
@tier2unitymax = 1000
@tier3unityreward = 18
@tier3unitymin = 250
@tier3unitymax = 1500
@tier4unityreward = 24
@tier4unitymin = 350
@tier4unitymax = 2000
@tier5unityreward = 48
@tier5unitymin = 700
@tier5unitymax = 4000

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500
@tier5researchreward = 48
@tier5researchmin = 300
@tier5researchmax = 1000

event = {
	id = cbshing_origins_eternal_leader_event.0
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		years_passed > 100
	}
	
	immediate = {
		every_country = {
			limit = { is_cbshing_eternal_leader_country = yes }
			country_event = { id = cbshing_origins_eternal_leader_event.1 }
		}
	}
}

#Eternal Leader Weakens, Uses Powers to Fight Crisis
country_event = {
	id = cbshing_origins_eternal_leader_event.1
	title = cbshing_origins_eternal_leader_event.1.name
	desc = cbshing_origins_eternal_leader_event.1.desc
	
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = FROM

	is_triggered_only = yes

	trigger = {
		years_passed > 100
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		has_global_flag = galactic_crisis_happened
		OR = {
			has_global_flag = prethoryn_subspace_echoes
			has_global_flag = prethoryn_invasion_happened 
			has_global_flag = extradimensional_invasion_happened
		}
		NOT = { has_country_flag = origins_eternal_leader_is_dead }
		NOT = { has_country_flag = origins_eternal_leader_crisis_decision_made }
		NOT = { has_country_flag = origins_eternal_leader_is_weakened }
	}

	immediate = {
		set_country_flag = origins_eternal_leader_crisis_decision_made
	}

	option = {
		name = cbshing_origins_eternal_leader_event.1.a
		custom_tooltip = cbshing_origins_eternal_leader_event.1.a.tooltip
		hidden_effect = {
			random_list = {
				20 = {
					add_modifier = { modifier = cbshing_origins_eternal_leader_fight_crisis }
				}
				50 = {
					add_modifier = { modifier = cbshing_origins_eternal_leader_fight_crisis }
					set_country_flag = origins_eternal_leader_is_weakened
					random_owned_leader = {
						limit = { leader_class = ruler }
						remove_trait = leader_trait_origins_ruler_eternal
						remove_ruler_trait  = leader_trait_origins_ruler_eternal
						add_trait = leader_trait_origins_ruler_eternal_weakened
						add_ruler_trait = leader_trait_origins_ruler_eternal_weakened
						set_skill = 3
					}
					if = { limit = { has_modifier = cbshing_origins_eternal_leader_religion_encouraged }
						remove_modifier = cbshing_origins_eternal_leader_religion_encouraged
					}
					if = { limit = { has_modifier = cbshing_origins_eternal_leader_religion_suppressed }
						remove_modifier = cbshing_origins_eternal_leader_religion_suppressed
					}
				}
				30 = {  
					kill_leader = { type = ruler } 
					#set_country_flag = eternal_leader_is_dead 
					#country_event = { id = cbshing_origins_eternal_leader_event.11 days = 2 }
				}
			}
		}
	}
	option = {
		name = cbshing_origins_eternal_leader_event.1.b
		#custom_tooltip = cbshing_origins_eternal_leader_event.1.b.tooltip
	}
}

event = {
	id = cbshing_origins_eternal_leader_event.2
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		years_passed > 100
	}
	
	immediate = {
		every_country = {
			limit = { is_cbshing_eternal_leader_country = yes }
			country_event = { id = cbshing_origins_eternal_leader_event.3 }
		}
	}
}

#Eternal Leader Weakens, Uses Powers to Save Nation
country_event = {
	id = cbshing_origins_eternal_leader_event.3
	title = cbshing_origins_eternal_leader_event.1.name
	desc = cbshing_origins_eternal_leader_event.1.desc
	
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = FROM

	is_triggered_only = yes

	trigger = {
		years_passed > 100
		num_owned_planets < 5
		is_at_war = yes
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		NOT = { has_country_flag = origins_eternal_leader_is_dead }
		NOT = { has_country_flag = origins_eternal_leader_nation_saving_decision_made }
		NOT = { has_country_flag = origins_eternal_leader_is_weakened }
	}

	immediate = {
		set_country_flag = origins_eternal_leader_nation_saving_decision_made
	}

	option = {
		name = cbshing_origins_eternal_leader_event.1.a
		custom_tooltip = cbshing_origins_eternal_leader_event.3.a.tooltip
		hidden_effect = {
			random_list = {
				20 = {
					add_modifier = { modifier = cbshing_origins_eternal_leader_turtle }
				}
				50 = {
					add_modifier = { modifier = cbshing_origins_eternal_leader_turtle }
					set_country_flag = origins_eternal_leader_is_weakened
					random_owned_leader = {
						limit = { leader_class = ruler }
						remove_trait = leader_trait_origins_ruler_eternal
						remove_ruler_trait  = leader_trait_origins_ruler_eternal
						add_trait = leader_trait_origins_ruler_eternal_weakened
						add_ruler_trait = leader_trait_origins_ruler_eternal_weakened
						set_skill = 3
					}
					if = { limit = { has_modifier = cbshing_origins_eternal_leader_religion_encouraged }
						remove_modifier = cbshing_origins_eternal_leader_religion_encouraged
					}
					if = { limit = { has_modifier = cbshing_origins_eternal_leader_religion_suppressed }
						remove_modifier = cbshing_origins_eternal_leader_religion_suppressed
					}
				}
				30 = {  
					kill_leader = { type = ruler show_notification = no } 
					#set_country_flag = origins_eternal_leader_is_dead 
					#country_event = { id = cbshing_origins_eternal_leader_event.11 days = 2 }
				}
			}
		}
	}
	option = {
		name = cbshing_origins_eternal_leader_event.1.b
		#custom_tooltip = cbshing_origins_eternal_leader_event.1.b.tooltip
	}
}

#Eternal Leader Dies
country_event = {
	id = cbshing_origins_eternal_leader_event.11
	title = cbshing_origins_eternal_leader_event.11.name
	desc = cbshing_origins_eternal_leader_event.11.desc
	
	picture = GFX_evt_throne_room
	show_sound = event_life_support_fail
	location = FROM

	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		NOT = { has_country_flag = origins_eternal_leader_is_dead }
		FROM = { 
			is_same_value = root.ruler
			OR = {
				has_trait = leader_trait_origins_ruler_eternal_weakened
				has_trait = leader_trait_origins_ruler_eternal
			}
		}
	}

	immediate = {
		set_country_flag = origins_eternal_leader_is_dead
		if = { limit = { has_modifier = cbshing_origins_eternal_leader_religion_encouraged }
			remove_modifier = cbshing_origins_eternal_leader_religion_encouraged
		}
		if = { limit = { has_modifier = cbshing_origins_eternal_leader_religion_suppressed }
			remove_modifier = cbshing_origins_eternal_leader_religion_suppressed
		}
	}

	option = {
		name = cbshing_origins_eternal_leader_event.11.a
		country_event = { id = cbshing_origins_eternal_leader_event.12 days = 30 }
	}
}

#Eternal Leader Country Reforms
country_event = {
	id = cbshing_origins_eternal_leader_event.12
	title = cbshing_origins_eternal_leader_event.12.name
	desc = cbshing_origins_eternal_leader_event.12.desc
	
	picture = GFX_evt_alien_propaganda
	show_sound = event_factions
	location = FROM

	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		has_country_flag = origins_eternal_leader_is_dead
		NOT = { has_country_flag = origins_eternal_leader_country_reform }
	}

	immediate = {
		set_country_flag = origins_eternal_leader_country_reform
		#origins_eternal_leader_country_suppressor
		#origins_eternal_leader_country_encourager
	}
	
	#Praise Leader As Martyr
	#Shift Towards Spiritualist
	option = {
		name = cbshing_origins_eternal_leader_event.12.a
		custom_tooltip = cbshing_origins_eternal_leader_event.12.a.tooltip
		set_country_flag = origins_eternal_leader_country_encourager_2
		add_monthly_resource_mult = {
			resource = unity
			value = @tier3unityreward
			min = @tier3unitymin
			max = @tier3unitymax
		}
		if = {
			limit = {
				NOT = { has_ethic = "ethic_fanatic_spiritualist" }
			}			
			#shift_ethic = "ethic_spiritualist"
			hidden_effect = {
				while = {
					count = 12			
					random_owned_pop = {
						limit = {
							is_same_species = owner.species
							NOT = { has_ethic = "ethic_spiritualist" }
						}
						pop_change_ethic = "ethic_spiritualist"
					}
				}
			}
		}
		country_event = { id = cbshing_origins_eternal_leader_event.13 days = 5 }
	}
	#Research Leader's Body for Immortality Potion
	#Shift Towards Materialist
	option = {
		name = cbshing_origins_eternal_leader_event.12.b
		custom_tooltip = cbshing_origins_eternal_leader_event.12.b.tooltip
		set_country_flag = origins_eternal_leader_country_suppressor_2
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier3researchreward
			min = @tier3researchmin
			max = @tier3researchmax
		}	
		if = {
			limit = {
				NOT = { has_ethic = "ethic_fanatic_materialist" }
			}			
			#shift_ethic = "ethic_materialist"
			hidden_effect = {
				while = {
					count = 12			
					random_owned_pop = {
						limit = {
							is_same_species = owner.species
							NOT = { has_ethic = "ethic_materialist" }
						}
						pop_change_ethic = "ethic_materialist"
					}
				}
			}
		}
		random_owned_planet = {
			limit = { 
				is_homeworld = yes
			}
			enable_special_project = {
				name = "ETERNAL_IMMORTALITY"
				location = this
				owner = root
			}
		}
	}
	#Nothing
	option = {
		name = cbshing_origins_eternal_leader_event.12.c
	}
}

#Eternal Leader Build a Tomb
country_event = {
	id = cbshing_origins_eternal_leader_event.13
	title = cbshing_origins_eternal_leader_event.13.name
	desc = cbshing_origins_eternal_leader_event.13.desc
	
	picture = GFX_evt_alien_ruins
	show_sound = event_construction
	location = FROM

	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		has_country_flag = origins_eternal_leader_is_dead
	}

	immediate = {

	}

	option = {
		name = cbshing_origins_eternal_leader_event.13.a
		hidden_effect = {
			set_country_flag = origins_eternal_leader_build_tomb
			set_country_flag = origins_eternal_leader_country_encourager_3
		}
		custom_tooltip = cbshing_origins_eternal_leader_event.13.a.tooltip
	}
}

#Eternal Leader Immortality Potion
country_event = {
	id = cbshing_origins_eternal_leader_event.15
	title = cbshing_origins_eternal_leader_event.15.name
	desc = cbshing_origins_eternal_leader_event.15.desc
	
	picture = GFX_evt_arguing_senate
	show_sound = event_factions
	location = FROM

	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		has_country_flag = origins_eternal_leader_is_dead
	}

	immediate = {

	}

	option = {
		name = cbshing_origins_eternal_leader_event.15.a
		custom_tooltip = cbshing_origins_eternal_leader_event.15.a.tooltip
		set_country_flag = origins_eternal_leader_country_eat_pops_ok
		if = {
			limit = {
				NOT = { has_ethic = "ethic_fanatic_materialist" }
			}			
			#shift_ethic = "ethic_materialist"
			hidden_effect = {
				while = {
					count = 12			
					random_owned_pop = {
						limit = {
							is_same_species = owner.species
							NOT = { has_ethic = "ethic_materialist" }
						}
						pop_change_ethic = "ethic_materialist"
					}
				}
			}
		}
		hidden_effect = { country_event = { id = cbshing_origins_eternal_leader_event.17 } }
		trigger = {
			NOT = { has_ethic = ethic_fanatic_xenophile }
			NOT = { has_ethic = ethic_fanatic_egalitarian }
		}
	}
	option = {
		name = cbshing_origins_eternal_leader_event.15.b
	}
}

#Eternal Leader Immortality Potion
event = {
	id = cbshing_origins_eternal_leader_event.16
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {

	}
	
	immediate = {
		every_country = {
			limit = { 
				is_cbshing_eternal_leader_country = yes 
				has_country_flag = origins_eternal_leader_is_dead
				has_country_flag = origins_eternal_leader_country_eat_pops_ok
			}
			country_event = { id = cbshing_origins_eternal_leader_event.17 }
		}
	}
}

#Eternal Leader Immortality Potion
country_event = {
	id = cbshing_origins_eternal_leader_event.17
	title = cbshing_origins_eternal_leader_event.17.name
	desc = cbshing_origins_eternal_leader_event.17.desc
	
	picture = GFX_evt_throne_room
	show_sound = event_planetary_riot
	location = FROM

	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_cbshing_eternal_leader_country = yes
		has_country_flag = origins_eternal_leader_is_dead
		has_country_flag = origins_eternal_leader_country_eat_pops_ok
	}

	immediate = {

	}

	option = {
		name = cbshing_origins_eternal_leader_event.17.a
		set_country_flag = origins_eternal_leader_country_ate_own_pop
		custom_tooltip = cbshing_origins_eternal_leader_event.17.a.tooltip
		if = { 
			limit = { 
				has_modifier = cbshing_origins_eternal_leader_immortality_potion_2 
			}
			add_modifier = { modifier = cbshing_origins_eternal_leader_immortality_potion days = 3600 }
			hidden_effect = { remove_modifier = cbshing_origins_eternal_leader_immortality_potion_2 }
			else = {
				add_modifier = { modifier = cbshing_origins_eternal_leader_immortality_potion_2 days = 3600 }
				hidden_effect = { remove_modifier = cbshing_origins_eternal_leader_immortality_potion }
			}
		}
		random_owned_pop = {
			kill_pop = yes
		}
		trigger = {
			NOT = { has_ethic = ethic_fanatic_egalitarian }
		}
	}
	option = {
		name = cbshing_origins_eternal_leader_event.17.b
		set_country_flag = origins_eternal_leader_country_ate_xeno_pop
		custom_tooltip = cbshing_origins_eternal_leader_event.17.b.tooltip
		if = { 
			limit = { 
				has_modifier = cbshing_origins_eternal_leader_immortality_potion_2 
			}
			add_modifier = { modifier = cbshing_origins_eternal_leader_immortality_potion days = 3600 }
			hidden_effect = { remove_modifier = cbshing_origins_eternal_leader_immortality_potion_2 }
			else = {
				add_modifier = { modifier = cbshing_origins_eternal_leader_immortality_potion_2 days = 3600 }
				hidden_effect = { remove_modifier = cbshing_origins_eternal_leader_immortality_potion }
			}
		}
		random_owned_pop = {
			limit = {
				NOT = { is_same_species = owner.species }
			}
			kill_pop = yes
		}
		if = {
			limit = {
				NOT = { has_ethic = "ethic_fanatic_xenophobe" }
			}		
			hidden_effect = {
				while = {
					count = 1			
					random_owned_pop = {
						limit = {
							is_same_species = owner.species
							NOT = { has_ethic = "ethic_xenophobe" }
						}
						pop_change_ethic = "ethic_xenophobe"
					}
				}
			}
		}
		trigger = {
			any_owned_pop = {
				NOT = { is_same_species = owner.species }
			}
			NOT = { has_ethic = ethic_fanatic_xenophile }
			NOT = { has_ethic = ethic_fanatic_egalitarian }
		}
	}
	option = {
		name = cbshing_origins_eternal_leader_event.17.c
		custom_tooltip = cbshing_origins_eternal_leader_event.17.c.tooltip
		remove_country_flag = origins_eternal_leader_country_eat_pops_ok
	}
}